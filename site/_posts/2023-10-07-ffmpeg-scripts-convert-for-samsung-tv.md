---
layout: post
title:  "ffmpeg-scripts: convert-for-samsung-tv"
---

<span class="hidden">Краткий обзор скрипта для конвертации видосов в формат, совместимый с Samsung Smart TV.</span>

## Мотивация

Место в моей скромной (но _зато своей_) панельной конуре (46 м<sup>2</sup>) занимает выдающийся предмет мебели — [Samsung The Serif](https://www.samsung.com/ru/lifestyle-tvs/the-serif/highlights/).

И я не шучу: это реально очень красивый телик. Но, как и все Samsung Smart TV, наверно — очень капризный в том, что касается поддерживаемых форматов файлов.

И дело тут совсем не в расширениях файлов, типа `*.mkv`, `*.avi`, и т.д.

Тот же `*.mkv`, например — это контейнер, а не какой-то конкретный способ кодировки видео.<br />
Т.е., по сути, это что-то вроде архива, содержащего какие-то данные видео, аудио дорожек и субтитров.

Для конвертации таких нагромождений (и более простых файлов, конечно же) — существует широко известный (и даже в широких кругах) инструмент — `ffmpeg`. Его я и использую в своём скрипте для конвертации видосов в формат, подходящий Samsung Smart TV 2020 года выпуска.

## `ffmpeg`

Это CLI тулза, которая, на самом деле, работает под капотом у многих видео редакторов.

Пользоваться ей, в чистом виде — довольно тяжеловато.<br />
Как минимум, потому, что там очень много разных параметров командной строки, да ещё и отличающихся по своему стилю от привычного мне.<br />
Например, там и однобуквенные, и многобуквенные ключи начинаются с одного дефиса. Хотя, какие-то есть и с двойным дефисом. Ну, такое. Ну ещё двоеточие используется и в качестве разделителя в значениях-списках, и в качестве разделителя ключ-значения, в зависимости от контекста. В общем, всё очень не стандартизированно и не единообразно.

Но разве меня это останавливает? Нее...

Устанавливаем `ffmpeg`, если ещё нет:

```bash
sudo apt update && \
sudo apt install -y ffmpeg
```

## Собственно, конвертация

Полезная часть скрипта (которая, на самом деле, была бессовестно нагуглена) выглядит так:

```bash
ffmpeg \                  # Сама тулза.
  -f matroska \           # Смешное название выходного формата, которое обычно сокращают как MKV.
  -i "${input_file}" \    # Сюда подаём путь до файла, который хотим сконвертировать.
  -c:v libx264 \          # Копируем видео дорожку, но кодируем каким-то `libx264` — хз, что это.
  -c:a aac \              # Копируем аудио дорожку, но в формате AAC.
  -c:s srt \              # Копируем дорожку сабов, но в формате SRT.
  -preset ultrafast \     # Хз, что это.
  -profile:v high \       # Хз, что это.
  -level:v 4.1 \          # Хз, что это.
  -pix_fmt yuv420p \      # Хз, что это. Ваще, жесть непонятно.
  -flags global_header \  # Хз, что это.
  "${output_file}"        # Сюда подаём путь до файла, который хотим получить на выходе.
```

## Сам скрипт

Можно взять [**отсюда**](https://github.com/Danand/ffmpeg-scripts):

```bash
git clone git@github.com:Danand/ffmpeg-scripts.git
```

У меня там ещё есть всякие скрипты, но нужный вот этот — [`convert-for-samsung-tv.sh`](https://github.com/Danand/ffmpeg-scripts/blob/main/convert-for-samsung-tv.sh)

Пользоваться так:

1. Конвертация одного файла:

   ```bash
   ./путь-до-скрипта/convert-for-samsung-tv.sh "путь-до-конкретного файла"
   ```

2. Конвертация всех файлов в текущей папке:

   ```bash
   cd "папка-с-видосами"
   ./путь-до-скрипта/convert-for-samsung-tv.sh
   ```

Если скрипт пригодился и кажется полезным, то можно добавить репу с ним в переменную `PATH`
