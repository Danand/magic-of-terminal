---
layout: post
title:  "bash-hash-benchmark"
---

<span class="hidden">–ü—Ä–æ –∑–∞–º–µ—Ä—ã —Ö—ç—à-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ <strong>Bash</strong>.</span>

## –ú–æ—Ç–∏–≤–∞—Ü–∏—è

–ù–∏–∫–∞–∫–æ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏, –∞—Ö–∞–∞—Ö–∞.

–ó–∞ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º–∏ —Å–Ω–∏–ø–ø–µ—Ç–∞–º–∏, –∫–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –æ–ø—ã—Ç–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –ª–∏—á–Ω–æ —É –º–µ–Ω—è.<br />
–ê, –º–æ–∂–µ—Ç –±—ã—Ç—å, –∏ –µ—Å—Ç—å.

–í—Ä–æ–¥–µ –±—ã, –±—ã–ª–∞ –∫–∞–∫–∞—è-—Ç–æ —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –±—ã–ª–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ö—ç—à–∏ –¥–ª—è –æ–≥—Ä–æ–º–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤, –∏ –∫–∞–∫-—Ç–æ —Å–∞–º —Å–æ–±–æ–π –≤–æ–∑–Ω–∏–∫ (–∏ —Ç–∞–∫–∂–µ –∏—Å—á–µ–∑) –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, _"–∞ –∫–∞–∫ –∂–µ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ?"_.

–ß–∏—Å—Ç–æ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ, –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –±—É–¥—Ç–æ –±—ã —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö ‚Äî —ç—Ç–æ **MD5**. –ù—É, —Ç–∏–ø–∞ –ø–æ—Ç–æ–º—É, —á—Ç–æ:

* –µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≥–ª—è–¥–∏—Ç –∫–æ—Ä–æ—Ç–∫–æ –∏ –ø—Ä–æ—Å—Ç–µ–Ω—å–∫–æ ü§°
* –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –º–∞–ª–æ —Å—Ç—Ä–∞—à–Ω—ã—Ö —à–∏–ø—è—â–∏—Ö –±—É–∫–≤ ü§°
* –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –≤—Å–µ–≥–æ –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞ ü§°

–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, —ç—Ç–∏–º –º–æ–∏ –∑–Ω–∞–Ω–∏—è –º–æ–≥–ª–∏ –±—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è, –Ω–æ –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ-—Ç–æ ‚Äî –Ω–µ –∑–Ω–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü. –¢–µ–º –±–æ–ª–µ–µ, —á—Ç–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–º–µ—Ä—ã –æ–∫–∞–∑–∞–ª–æ—Å—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ.

## –ó–∞–º–µ—Ä—ã

1. –ú–µ—Ç–æ–¥–æ–º –Ω–µ–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≥—É–≥–ª–µ–Ω–∏—è, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å–ø–∏—Å–æ–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤ –ø–æ—á—Ç–∏ –ª—é–±–æ–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π **Linux** –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤.
2. –ó–∞–∫–∏–¥—ã–≤–∞–µ–º –∏—Ö –≤ —Å–ø–∏—Å–æ–∫:

   ```bash
   algos=( \
     "md5sum" \
     "sha1sum" \
     "sha224sum" \
     "sha256sum" \
     "sha384sum" \
     "sha512sum" \
     "b2sum" \
     "openssl dgst -md5" \
     "openssl dgst -sha1" \
     "openssl dgst -sha256" \
     "openssl dgst -sha512" \
   )
   ```

3. –ü–∏—à–µ–º –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ —á–µ–≥–æ-—Ç–æ –≤—Ä–æ–¥–µ –±–µ–Ω—á–º–∞—Ä–∫–∞:<br />[`hash-benchmark.sh`](https://github.com/Danand/bash-hash-benchmark/blob/main/hash-benchmark.sh)
4. –ù–∞–≥–ª–æ –ø–æ–ª—å–∑—É—è—Å—å —Ç–µ–º, —á—Ç–æ —É –Ω–∏—Ö —É –≤—Å–µ—Ö –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥–æ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ, –ø–æ –æ—á–µ—Ä–µ–¥–∏:

   ```bash
   for algo in "${algos[@]}"; do
     ./hash-benchmark.sh \
       "${algo}" \
       10 \
       104857600
   done \
   | sort -t $'\t' -k 2 -n \
   | column -s $'\t' -t
   ```

## –ò—Ç–æ–≥–∏

–ö –º–æ–µ–º—É —É–¥–∏–≤–ª–µ–Ω–∏—é, –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–º –æ–∫–∞–∑–∞–ª—Å—è **SHA-1**, –Ω–æ –∏–º–µ–Ω–Ω–æ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ [**OpenSSL**](https://www.openssl.org/).

### 100 MB file, 1 iteration

| Function | Time elapsed (ms.) |
|:--------|--------:|
| `openssl dgst -sha1` | 406 |
| `b2sum` | 427 |
| `md5sum`| 573 |
| `openssl dgst -md5` | 583 |
| `openssl dgst -sha512` | 529 |
| `sha1sum` | 678 |
| `openssl dgst -sha256` | 733 |
| `sha384sum` | 872 |
| `sha512sum` | 872 |
| `sha224sum` | 1354 |
| `sha256sum` | 1362 |

### 100 MB file, 10 iterations

| Function | Time elapsed (ms.) |
|:--------|--------:|
| `openssl dgst -sha1` | 4006 |
| `b2sum` | 4277 |
| `openssl dgst -md5` | 5086 |
| `openssl dgst -sha512` | 5170 |
| `md5sum` | 5249 |
| `sha1sum` | 5882 |
| `openssl dgst -sha256` | 7278 |
| `sha512sum` | 8452 |
| `sha384sum` | 8521 |
| `sha256sum` | 13423 |
| `sha224sum` | 13446 |

### 100 MB file, 100 iterations

| Function | Time elapsed (ms.) |
|:--------|--------:|
| `openssl dgst -sha1` | 38553 |
| `b2sum` | 42591 |
| `openssl dgst -md5` | 49940 |
| `md5sum` | 50033 |
| `openssl dgst -sha512` | 51910 |
| `sha1sum` | 57393 |
| `openssl dgst -sha256` | 71788 |
| `sha512sum` | 84725 |
| `sha384sum` | 84855 |
| `sha256sum` | 134613 |
| `sha224sum` | 132943 |

## –ë–æ–Ω—É—Å

–í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞—Ö —Ö–æ–¥—è—Ç –ª–µ–≥–µ–Ω–¥—ã –æ–± –µ—â—ë –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–µ (—á–µ–º –≤—Å–µ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ) ‚Äî [**xxHash**](https://github.com/Cyan4973/xxHash).

–ï–≥–æ –º–æ–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ; –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ **APT**:

```bash
sudo apt update && \
sudo apt install -y xxhash
```

### 100 MB file, 10 iterations (**xxHash**)

| Function | Time elapsed (ms.) |
|:--------|--------:|
| `xxh128sum` | 236 |
| `xxhsum` | 307 |
| `xxh64sum` | 310 |
| `xxh32sum` | 430 |
| `openssl dgst -sha1` | 1429 |
